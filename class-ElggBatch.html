<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="generator" content="ApiGen 2.8.0">

	<title>Class ElggBatch</title>

	<script type="text/javascript" src="resources/combined.js?117538352"></script>
	<script type="text/javascript" src="elementlist.js?224625972"></script>
	<link rel="stylesheet" type="text/css" media="all" href="resources/style.css?3505392360">

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
			<h3>Packages</h3>
			<ul>
				<li><a href="package-ClipIt.html">ClipIt<span></span></a>
						<ul>
				<li><a href="package-ClipIt.clipit.html">clipit<span></span></a>
						<ul>
				<li><a href="package-ClipIt.clipit.api.html">api</a>
						</li>
							</ul></li>
				<li><a href="package-ClipIt.urjc.html">urjc<span></span></a>
						<ul>
				<li><a href="package-ClipIt.urjc.backend.html">backend</a>
						</li>
							</ul></li></ul></li>
				<li class="active"><a href="package-Elgg.html">Elgg<span></span></a>
						<ul>
				<li class="active"><a href="package-Elgg.Core.html">Core<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.Access.html">Access</a>
						</li>
				<li><a href="package-Elgg.Core.Authentication.html">Authentication</a>
						</li>
				<li><a href="package-Elgg.Core.Cache.html">Cache</a>
						</li>
				<li><a href="package-Elgg.Core.Caches.html">Caches</a>
						</li>
				<li><a href="package-Elgg.Core.Core.html">Core</a>
						</li>
				<li><a href="package-Elgg.Core.DataMode.html">DataMode<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.DataMode.Site.html">Site</a>
						</li>
							</ul></li>
				<li class="active"><a href="package-Elgg.Core.DataModel.html">DataModel<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.DataModel.Annotations.html">Annotations</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Entities.html">Entities</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Extender.html">Extender</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.File.html">File</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Importable.html">Importable</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Loggable.html">Loggable</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Notable.html">Notable</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.Object.html">Object</a>
						</li>
				<li><a href="package-Elgg.Core.DataModel.User.html">User</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Core.DataStorage.html">DataStorage</a>
						</li>
				<li><a href="package-Elgg.Core.Exception.html">Exception</a>
						</li>
				<li><a href="package-Elgg.Core.Exceptions.html">Exceptions<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.Exceptions.Stub.html">Stub</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Core.FileStore.html">FileStore<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.FileStore.Disk.html">Disk</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Core.Groups.html">Groups</a>
						</li>
				<li><a href="package-Elgg.Core.Helpers.html">Helpers</a>
						</li>
				<li><a href="package-Elgg.Core.HMAC.html">HMAC</a>
						</li>
				<li><a href="package-Elgg.Core.Memcache.html">Memcache</a>
						</li>
				<li><a href="package-Elgg.Core.Metadata.html">Metadata</a>
						</li>
				<li><a href="package-Elgg.Core.Navigation.html">Navigation</a>
						</li>
				<li><a href="package-Elgg.Core.ODD.html">ODD</a>
						</li>
				<li><a href="package-Elgg.Core.Output.html">Output</a>
						</li>
				<li><a href="package-Elgg.Core.Plugins.html">Plugins<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.Plugins.Settings.html">Settings</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Core.Sessions.html">Sessions</a>
						</li>
				<li><a href="package-Elgg.Core.SocialModel.html">SocialModel<span></span></a>
						<ul>
				<li><a href="package-Elgg.Core.SocialModel.Friendable.html">Friendable</a>
						</li>
				<li><a href="package-Elgg.Core.SocialModel.Locatable.html">Locatable</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Core.WebServicesAPI.html">WebServicesAPI</a>
						</li>
				<li><a href="package-Elgg.Core.Widgets.html">Widgets</a>
						</li>
				<li><a href="package-Elgg.Core.XML.html">XML</a>
						</li>
				<li><a href="package-Elgg.Core.XMLRPC.html">XMLRPC</a>
						</li>
							</ul></li>
				<li><a href="package-Elgg.Exceptions.html">Exceptions<span></span></a>
						<ul>
				<li><a href="package-Elgg.Exceptions.Stub.html">Stub</a>
						</li>
							</ul></li></ul></li>
				<li><a href="package-None.html">None</a>
						</li>
				<li><a href="package-PHP.html">PHP</a>
						</li>
			</ul>
		</div>

		<hr>


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-ElggAttributeLoader.html">ElggAttributeLoader</a></li>
				<li class="active"><a href="class-ElggBatch.html">ElggBatch</a></li>
				<li><a href="class-ElggData.html">ElggData</a></li>
			</ul>





		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text">
		<input type="submit" value="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
				<a href="package-Elgg.Core.DataModel.html" title="Summary of Elgg\Core\DataModel"><span>Package</span></a>
			</li>
			<li class="active">
<span>Class</span>			</li>
		</ul>
		<ul>
			<li>
				<a href="tree.html" title="Tree view of classes, interfaces, traits and exceptions"><span>Tree</span></a>
			</li>
		</ul>
		<ul>
		</ul>
	</div>

<div id="content" class="class">
	<h1>Class ElggBatch</h1>


	<div class="description">
	
<p>Efficiently run operations on batches of results for any function that
supports an options array.</p>

<p>This is usually used with elgg_get_entities() and friends,
elgg_get_annotations(), and elgg_get_metadata().</p>

<p>If you pass a valid PHP callback, all results will be run through that
callback. You can still foreach() through the result set after. Valid PHP
callbacks can be a string, an array, or a closure. <a href="http://php.net/manual/en/language.pseudo-types.php">http://php.net/manual/en/language.pseudo-types.php</a></p>

<p>The callback function must accept 3 arguments: an entity, the getter used,
and the options used.</p>

<p>Results from the callback are stored in callbackResult. If the callback
returns only booleans, callbackResults will be the combined result of all calls.
If no entities are processed, callbackResults will be null.</p>

<p>If the callback returns anything else, callbackresult will be an indexed
array of whatever the callback returns. If returning error handling information,
you should include enough information to determine which result you're referring
to.</p>

<p>Don't combine returning bools and returning something else.</p>

<p>Note that returning false will not stop the foreach.</p>

	</div>

	<dl class="tree">
		<dd style="padding-left:0px">
<b><span>ElggBatch</span></b>			
			 implements 
				<a href="class-Iterator.html"><span>Iterator</span></a>
			
			
		</dd>
	</dl>








	<div class="info">
		
		
		
		<b>Package:</b> <a href="package-Elgg.html">Elgg</a>\<a href="package-Elgg.Core.html">Core</a>\<a href="package-Elgg.Core.DataModel.html">DataModel</a><br>

				<b>Since:</b>
				1.8<br>
				<b>Link:</b>
				<a href="http://docs.elgg.org/DataModel/ElggBatch">http://docs.elgg.org/DataModel/ElggBatch</a><br>
				<b>Example:</b>
				&lt;code&gt; // using foreach $batch = new ElggBatch('elgg_get_entities',
array()); $batch-&gt;setIncrementOffset(false); foreach ($batch as $entity) {
$entity-&gt;disable(); } // using both a callback $callback = function($result,
$getter, $options) { var_dump("Looking at annotation id: $result-&gt;id");
return true; } $batch = new ElggBatch('elgg_get_annotations', array('guid' =&gt;
2), $callback); &lt;/code&gt;<br>
				<b>Warning:</b>
				If your callback or foreach loop deletes or disable entities you MUST call
setIncrementOffset(false) or set that when instantiating. This forces the offset
to stay what it was in the $options array.<br>
		<b>Located at</b> <a href="source-class-ElggBatch.html#2-433" title="Go to source code">ElggBatch.php</a><br>
	</div>



	<table class="summary" id="methods">
	<caption>Methods summary</caption>
	<tr data-order="__construct" id="___construct">

		<td class="attributes"><code>
			 public 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#___construct">#</a>
		<code><a href="source-class-ElggBatch.html#166-236" title="Go to source code">__construct</a>( <span>string <var>$getter</var></span>, <span>array <var>$options</var></span>, <span>mixed <var>$callback</var> = <span class="php-keyword1">null</span></span>, <span>integer <var>$chunk_size</var> = <span class="php-num">25</span></span>, <span>boolean <var>$inc_offset</var> = <span class="php-keyword1">true</span></span> )</code>

		<div class="description short">
			
<p>Batches operations on any elgg_get_*() or compatible function that supports
an options array.</p>

		</div>

		<div class="description detailed hidden">
			
<p>Batches operations on any elgg_get_*() or compatible function that supports
an options array.</p>

<p>Instead of returning all objects in memory, it goes through $chunk_size
objects, then requests more from the server. This avoids OOM errors.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$getter</var></dt>
					<dd><code>string</code><br>$getter The function used to get objects. Usually an elgg_get_*() function, but
can be any valid PHP callback.</dd>
					<dt><var>$options</var></dt>
					<dd><code>array</code><br>$options The options array to pass to the getter function. If limit is not set,
10 is used as the default. In most cases that is not what you want.</dd>
					<dt><var>$callback</var></dt>
					<dd><code>mixed</code><br>$callback An optional callback function that all results will be passed to upon
load. The callback needs to accept $result, $getter, $options.</dd>
					<dt><var>$chunk_size</var></dt>
					<dd><code>integer</code><br>$chunk_size The number of entities to pull in before requesting more. You have
to balance this between running out of memory in PHP and hitting the db server
too often.</dd>
					<dt><var>$inc_offset</var></dt>
					<dd><code>boolean</code><br>$inc_offset Increment the offset on each fetch. This must be false for callbacks
that delete rows. You can set this after the object is created with <code><a href="class-ElggBatch.html#_setIncrementOffset">ElggBatch::setIncrementOffset()</a></code>.</dd>
				</dl></div>





		</div>
		</div></td>
	</tr>
	<tr data-order="reportIncompleteEntity" id="_reportIncompleteEntity">

		<td class="attributes"><code>
			 public 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_reportIncompleteEntity">#</a>
		<code><a href="source-class-ElggBatch.html#238-247" title="Go to source code">reportIncompleteEntity</a>( <span><code><a href="class-stdClass.html">stdClass</a></code> <var>$row</var></span> )</code>

		<div class="description short">
			
<p>Tell the process that an entity was incomplete during a fetch</p>

		</div>

		<div class="description detailed hidden">
			
<p>Tell the process that an entity was incomplete during a fetch</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$row</var></dt>
					<dd><code><code><a href="class-stdClass.html">stdClass</a></code></code><br>$row</dd>
				</dl></div>





		</div>
		</div></td>
	</tr>
	<tr data-order="setIncrementOffset" id="_setIncrementOffset">

		<td class="attributes"><code>
			 public 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_setIncrementOffset">#</a>
		<code><a href="source-class-ElggBatch.html#335-344" title="Go to source code">setIncrementOffset</a>( <span>boolean <var>$increment</var> = <span class="php-keyword1">true</span></span> )</code>

		<div class="description short">
			
<p>Increment the offset from the original options array? Setting to false is
required for callbacks that delete rows.</p>

		</div>

		<div class="description detailed hidden">
			
<p>Increment the offset from the original options array? Setting to false is
required for callbacks that delete rows.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$increment</var></dt>
					<dd><code>boolean</code><br>$increment Set to false when deleting data</dd>
				</dl></div>





		</div>
		</div></td>
	</tr>
	<tr data-order="rewind" id="_rewind">

		<td class="attributes"><code>
			 public 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_rewind">#</a>
		<code><a href="source-class-ElggBatch.html#350-366" title="Go to source code">rewind</a>( )</code>

		<div class="description short">
			
<p>PHP Iterator Interface</p>

		</div>

		<div class="description detailed hidden">
			
<p>PHP Iterator Interface</p>






				<h4>See</h4>
				<div class="list">
						<code><code><a href="class-Iterator.html#_rewind">Iterator::rewind()</a></code></code><br>
				</div>


				<h4>Implementation of</h4>
				<div class="list"><code><a href="class-Iterator.html#_rewind">Iterator::rewind()</a></code></div>
		</div>
		</div></td>
	</tr>
	<tr data-order="current" id="_current">

		<td class="attributes"><code>
			 public 
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_current">#</a>
		<code><a href="source-class-ElggBatch.html#368-376" title="Go to source code">current</a>( )</code>

		<div class="description short">
			
<p>PHP Iterator Interface</p>

		</div>

		<div class="description detailed hidden">
			
<p>PHP Iterator Interface</p>




				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br>
				</div>


				<h4>See</h4>
				<div class="list">
						<code><code><a href="class-Iterator.html#_current">Iterator::current()</a></code></code><br>
				</div>


				<h4>Implementation of</h4>
				<div class="list"><code><a href="class-Iterator.html#_current">Iterator::current()</a></code></div>
		</div>
		</div></td>
	</tr>
	<tr data-order="key" id="_key">

		<td class="attributes"><code>
			 public 
			integer
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_key">#</a>
		<code><a href="source-class-ElggBatch.html#378-386" title="Go to source code">key</a>( )</code>

		<div class="description short">
			
<p>PHP Iterator Interface</p>

		</div>

		<div class="description detailed hidden">
			
<p>PHP Iterator Interface</p>




				<h4>Returns</h4>
				<div class="list">
					<code>integer</code><br>
				</div>


				<h4>See</h4>
				<div class="list">
						<code><code><a href="class-Iterator.html#_key">Iterator::key()</a></code></code><br>
				</div>


				<h4>Implementation of</h4>
				<div class="list"><code><a href="class-Iterator.html#_key">Iterator::key()</a></code></div>
		</div>
		</div></td>
	</tr>
	<tr data-order="next" id="_next">

		<td class="attributes"><code>
			 public 
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_next">#</a>
		<code><a href="source-class-ElggBatch.html#388-418" title="Go to source code">next</a>( )</code>

		<div class="description short">
			
<p>PHP Iterator Interface</p>

		</div>

		<div class="description detailed hidden">
			
<p>PHP Iterator Interface</p>




				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br>
				</div>


				<h4>See</h4>
				<div class="list">
						<code><code><a href="class-Iterator.html#_next">Iterator::next()</a></code></code><br>
				</div>


				<h4>Implementation of</h4>
				<div class="list"><code><a href="class-Iterator.html#_next">Iterator::next()</a></code></div>
		</div>
		</div></td>
	</tr>
	<tr data-order="valid" id="_valid">

		<td class="attributes"><code>
			 public 
			boolean
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_valid">#</a>
		<code><a href="source-class-ElggBatch.html#420-432" title="Go to source code">valid</a>( )</code>

		<div class="description short">
			
<p>PHP Iterator Interface</p>

		</div>

		<div class="description detailed hidden">
			
<p>PHP Iterator Interface</p>




				<h4>Returns</h4>
				<div class="list">
					<code>boolean</code><br>
				</div>


				<h4>See</h4>
				<div class="list">
						<code><code><a href="class-Iterator.html#_valid">Iterator::valid()</a></code></code><br>
				</div>


				<h4>Implementation of</h4>
				<div class="list"><code><a href="class-Iterator.html#_valid">Iterator::valid()</a></code></div>
		</div>
		</div></td>
	</tr>
	</table>












	<table class="summary" id="properties">
	<caption>Properties summary</caption>
	<tr data-order="callbackResult" id="$callbackResult">
		<td class="attributes"><code>
			public  
			mixed
		</code></td>

		<td class="name">
				<a href="source-class-ElggBatch.html#138-143" title="Go to source code"><var>$callbackResult</var></a>
		</td>
		<td class="value"><code><span class="php-keyword1">null</span></code></td>
		<td class="description"><div>
			<a href="#$callbackResult" class="anchor">#</a>

			<div class="description short">
				
<p>The result of running all entities through the callback function.</p>

			</div>

			<div class="description detailed hidden">
				
<p>The result of running all entities through the callback function.</p>


			</div>
		</div></td>
	</tr>
	</table>






</div>

	<div id="footer">
		 API documentation generated by <a href="http://apigen.org">ApiGen 2.8.0</a>
	</div>
</div>
</div>
</body>
</html>
